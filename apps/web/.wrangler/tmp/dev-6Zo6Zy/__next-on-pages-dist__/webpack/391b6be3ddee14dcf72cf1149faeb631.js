var M={},Mn=(Un,xn,wn)=>(M.__chunk_5683=(gn,z,A)=>{"use strict";A.d(z,{n:()=>N});var R=A(7895);let k=new(A(5087)).Q({url:process.env.UPSTASH_REDIS_REST_URL,token:process.env.UPSTASH_REDIS_REST_TOKEN});class I{constructor(p){this.redis=p}async get(p){try{return await this.redis.get(p)}catch(l){return console.error("Cache get error:",l),null}}async set(p,l,d=3600){try{await this.redis.setex(p,d,l)}catch(m){console.error("Cache set error:",m)}}async delete(p){try{await this.redis.del(p)}catch(l){console.error("Cache delete error:",l)}}async clearPattern(p){try{let l=await this.redis.keys(p);l.length>0&&await this.redis.del(...l)}catch(l){console.error("Cache clear error:",l)}}async getOrSet(p,l,d=3600){let m=await this.get(p);if(m)return m;let O=await l();return await this.set(p,O,d),O}async getVenueCategories(p,l){let d=`venue:category:${p}`,m=await this.get(d);if(m)return m;let O=await l();return await this.set(d,O,86400),O}async getMenuItemCategories(p,l){let d=`item:category:${p}`,m=await this.get(d);if(m)return m;let O=await l();return await this.set(d,O,604800),O}}let S=new I(k),v=(0,R.UU)("https://elhlcdiosomutugpneoc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVsaGxjZGlvc29tdXR1Z3BuZW9jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5MDU3NTMsImV4cCI6MjA3NDQ4MTc1M30.d92ZJG5E_9r7bOlRLBXRI6gcB_7ERVbL-Elp7fk4avY");class E{async invoke(p,l){let{data:d,error:m}=await v.functions.invoke("gemini-features",{body:{action:p,payload:l}});if(m)throw Error(`Gemini API Error: ${m.message}`);if(!d.success)throw Error(`Gemini Operation Failed: ${d.message||"Unknown error"}`);return d.data}async categorizeVenue(p){let l=`venue:category:${p.id}`,d=await S.get(l);if(d)return d;try{let m=await this.invoke("categorize-venue",{name:p.name,address:p.address,description:p.description,lat:p.latitude,lng:p.longitude});return await S.set(l,m,86400),m}catch(m){throw console.error("Gemini categorization error:",m),Error("Failed to categorize venue")}}async categorizeMenuItem(p){let l=`item:category:${p.id}`,d=await S.get(l);if(d)return d;try{let m=await this.invoke("categorize-menu",{items:[{id:p.id,name:p.name,description:p.description}],venueName:p.venue_context?.name}),O=m[p.id]||Object.values(m)[0];if(!O)throw Error("No categorization returned");return await S.set(l,O,604800),O}catch(m){throw console.error("Menu item categorization error:",m),Error("Failed to categorize menu item")}}async generateVenueImage(p){let l=`Create a professional, photorealistic image of ${p.name}, a ${p.primary_category}.
Atmosphere: ${p.ambiance_tags.join(", ")}
Features: ${p.special_features.join(", ")}`;try{return await this.invoke("generate-image",{prompt:l,modelPreference:"quality"})}catch(d){throw console.error("Image generation error:",d),Error("Failed to generate venue image")}}async generateMenuItemImage(p){let l=`Professional food photography of ${p.name}. ${p.description}. Cuisine: ${p.cuisine_style}.`;try{return await this.invoke("generate-image",{prompt:l,modelPreference:"fast"})}catch(d){throw console.error("Menu image generation error:",d),Error("Failed to generate menu item image")}}}let N=new E},M.__chunk_5087=(gn,z,A)=>{A.d(z,{Q:()=>In});let R=xn.crypto.subtle;var k=Object.defineProperty,I={},S={UpstashError:()=>E,UpstashJSONParseError:()=>T,UrlError:()=>N};for(var v in S)k(I,v,{get:S[v],enumerable:!0});var E=class extends Error{constructor(e,t){super(e,t),this.name="UpstashError"}},N=class extends Error{constructor(e){super(`Upstash Redis client was passed an invalid URL. You should pass a URL starting with https. Received: "${e}". `),this.name="UrlError"}},T=class extends E{constructor(e,t){super(`Unable to parse response body: ${e.length>200?e.slice(0,200)+"...":e}`,t),this.name="UpstashJSONParseError"}};function p(e){try{return function t(s){let n=Array.isArray(s)?s.map(i=>{try{return t(i)}catch{return i}}):JSON.parse(s);return typeof n=="number"&&n.toString()!==s?s:n}(e)}catch{return e}}function l(e){return[e[0],...p(e.slice(1))]}function d(e){let[t,s]=e,n=[];for(let i=0;i<s.length;i+=2)n.push({key:s[i],type:s[i+1]});return[t,n]}function m(e){if(typeof e=="object"&&e!==null&&!Array.isArray(e))return e;if(!Array.isArray(e))return{};let t={};for(let s=0;s<e.length;s+=2)typeof e[s]=="string"&&(t[e[s]]=e[s+1]);return t}var O=class{baseUrl;headers;options;readYourWrites;upstashSyncToken="";hasCredentials;retry;constructor(e){if(this.options={backend:e.options?.backend,agent:e.agent,responseEncoding:e.responseEncoding??"base64",cache:e.cache,signal:e.signal,keepAlive:e.keepAlive??!0},this.upstashSyncToken="",this.readYourWrites=e.readYourWrites??!0,this.baseUrl=(e.baseUrl||"").replace(/\/$/,""),this.baseUrl&&!/^https?:\/\/[^\s#$./?].\S*$/.test(this.baseUrl))throw new N(this.baseUrl);this.headers={"Content-Type":"application/json",...e.headers},this.hasCredentials=!!(this.baseUrl&&this.headers.authorization.split(" ")[1]),this.options.responseEncoding==="base64"&&(this.headers["Upstash-Encoding"]="base64"),this.retry=typeof e.retry!="boolean"||e.retry?{attempts:e.retry?.retries??5,backoff:e.retry?.backoff??(t=>50*Math.exp(t))}:{attempts:1,backoff:()=>0}}mergeTelemetry(e){this.headers=U(this.headers,"Upstash-Telemetry-Runtime",e.runtime),this.headers=U(this.headers,"Upstash-Telemetry-Platform",e.platform),this.headers=U(this.headers,"Upstash-Telemetry-Sdk",e.sdk)}async request(e){let t,s=function(...u){let y={};for(let g of u)if(g)for(let[b,f]of Object.entries(g))f!=null&&(y[b]=f);return y}(this.headers,e.headers??{}),n=[this.baseUrl,...e.path??[]].join("/"),i=s.Accept==="text/event-stream",c=e.signal??this.options.signal,o=typeof c=="function",a={cache:this.options.cache,method:"POST",headers:s,body:JSON.stringify(e.body),keepalive:this.options.keepAlive,agent:this.options.agent,signal:o?c():c,backend:this.options.backend};if(this.hasCredentials||console.warn("[Upstash Redis] Redis client was initialized without url or token. Failed to execute command."),this.readYourWrites){let u=this.upstashSyncToken;this.headers["upstash-sync-token"]=u}let h=null,x=null;for(let u=0;u<=this.retry.attempts;u++)try{h=await fetch(n,a);break}catch(y){if(a.signal?.aborted&&o)throw y;if(a.signal?.aborted){h=new Response(new Blob([JSON.stringify({result:a.signal.reason??"Aborted"})]),{status:200,statusText:a.signal.reason??"Aborted"});break}x=y,u<this.retry.attempts&&await new Promise(g=>setTimeout(g,this.retry.backoff(u)))}if(!h)throw x??Error("Exhausted all retries");if(!h.ok){let u,y=await h.text();try{u=JSON.parse(y)}catch(g){throw new T(y,{cause:g})}throw new E(`${u.error}, command was: ${JSON.stringify(e.body)}`)}if(this.readYourWrites){let u=h.headers;this.upstashSyncToken=u.get("upstash-sync-token")??""}if(i&&e&&e.onMessage&&h.body){let u=h.body.getReader(),y=new TextDecoder;return(async()=>{try{let g="";for(;;){let{value:b,done:f}=await u.read();if(f)break;let un=(g+=y.decode(b,{stream:!0})).split(`
`);if((g=un.pop()||"").length>1048576)throw Error("Buffer size exceeded (1MB)");for(let mn of un)if(mn.startsWith("data: ")){let Cn=mn.slice(6);e.onMessage?.(Cn)}}}catch(g){g instanceof Error&&g.name==="AbortError"||console.error("Stream reading error:",g)}finally{try{await u.cancel()}catch{}}})(),{result:1}}let w=await h.text();try{t=JSON.parse(w)}catch(u){throw new T(w,{cause:u})}if(this.readYourWrites){let u=h.headers;this.upstashSyncToken=u.get("upstash-sync-token")??""}return this.options.responseEncoding==="base64"?Array.isArray(t)?t.map(({result:u,error:y})=>({result:C(u),error:y})):{result:C(t.result),error:t.error}:t}};function P(e){let t="";try{let s=atob(e),n=s.length,i=new Uint8Array(n);for(let c=0;c<n;c++)i[c]=s.charCodeAt(c);t=new TextDecoder().decode(i)}catch{t=e}return t}function C(e){let t;switch(typeof e){case"undefined":return e;case"number":t=e;break;case"object":t=Array.isArray(e)?e.map(s=>typeof s=="string"?P(s):Array.isArray(s)?s.map(n=>C(n)):s):null;break;case"string":t=e==="OK"?"OK":P(e)}return t}function U(e,t,s){return s&&(e[t]=e[t]?[e[t],s].join(","):s),e}var yn=e=>{switch(typeof e){case"string":case"number":case"boolean":return e;default:return JSON.stringify(e)}},r=class{command;serialize;deserialize;headers;path;onMessage;isStreaming;signal;constructor(e,t){if(this.serialize=yn,this.deserialize=t?.automaticDeserialization===void 0||t.automaticDeserialization?t?.deserialize??p:s=>s,this.command=e.map(s=>this.serialize(s)),this.headers=t?.headers,this.path=t?.path,this.onMessage=t?.streamOptions?.onMessage,this.isStreaming=t?.streamOptions?.isStreaming??!1,this.signal=t?.streamOptions?.signal,t?.latencyLogging){let s=this.exec.bind(this);this.exec=async n=>{let i=performance.now(),c=await s(n),o=(performance.now()-i).toFixed(2);return console.log(`Latency for \x1B[38;2;19;185;39m${this.command[0].toString().toUpperCase()}\x1B[0m: \x1B[38;2;0;255;255m${o} ms\x1B[0m`),c}}}async exec(e){let{result:t,error:s}=await e.request({body:this.command,path:this.path,upstashSyncToken:e.upstashSyncToken,headers:this.headers,onMessage:this.onMessage,isStreaming:this.isStreaming,signal:this.signal});if(s)throw new E(s);if(t===void 0)throw TypeError("Request did not return a result");return this.deserialize(t)}},L=class extends r{constructor(e,t){let s=["hrandfield",e[0]];typeof e[1]=="number"&&s.push(e[1]),e[2]&&s.push("WITHVALUES"),super(s,{deserialize:e[2]?n=>function(i){if(i.length===0)return null;let c={};for(let o=0;o<i.length;o+=2){let a=i[o],h=i[o+1];try{c[a]=JSON.parse(h)}catch{c[a]=h}}return c}(n):t?.deserialize,...t})}},D=class extends r{constructor(e,t){super(["append",...e],t)}},J=class extends r{constructor([e,t,s],n){let i=["bitcount",e];typeof t=="number"&&i.push(t),typeof s=="number"&&i.push(s),super(i,n)}},_=class{constructor(e,t,s,n=i=>i.exec(this.client)){this.client=t,this.opts=s,this.execOperation=n,this.command=["bitfield",...e]}command;chain(...e){return this.command.push(...e),this}get(...e){return this.chain("get",...e)}set(...e){return this.chain("set",...e)}incrby(...e){return this.chain("incrby",...e)}overflow(e){return this.chain("overflow",e)}exec(){let e=new r(this.command,this.opts);return this.execOperation(e)}},j=class extends r{constructor(e,t){super(["bitop",...e],t)}},$=class extends r{constructor(e,t){super(["bitpos",...e],t)}},F=class extends r{constructor([e,t,s],n){super(["COPY",e,t,...s?.replace?["REPLACE"]:[]],{...n,deserialize:i=>i>0?"COPIED":"NOT_COPIED"})}},Y=class extends r{constructor(e){super(["dbsize"],e)}},G=class extends r{constructor(e,t){super(["decr",...e],t)}},X=class extends r{constructor(e,t){super(["decrby",...e],t)}},B=class extends r{constructor(e,t){super(["del",...e],t)}},W=class extends r{constructor(e,t){super(["echo",...e],t)}},H=class extends r{constructor([e,t,s],n){super(["eval_ro",e,t.length,...t,...s??[]],n)}},K=class extends r{constructor([e,t,s],n){super(["eval",e,t.length,...t,...s??[]],n)}},V=class extends r{constructor([e,t,s],n){super(["evalsha_ro",e,t.length,...t,...s??[]],n)}},q=class extends r{constructor([e,t,s],n){super(["evalsha",e,t.length,...t,...s??[]],n)}},On=class extends r{constructor(e,t){super(e.map(s=>typeof s=="string"?s:String(s)),t)}},Z=class extends r{constructor(e,t){super(["exists",...e],t)}},Q=class extends r{constructor(e,t){super(["expire",...e.filter(Boolean)],t)}},ee=class extends r{constructor(e,t){super(["expireat",...e],t)}},te=class extends r{constructor([e,t,s],n){super(["fcall",e,...t?[t.length,...t]:[0],...s??[]],n)}},se=class extends r{constructor([e,t,s],n){super(["fcall_ro",e,...t?[t.length,...t]:[0],...s??[]],n)}},ne=class extends r{constructor(e,t){let s=["flushall"];e&&e.length>0&&e[0].async&&s.push("async"),super(s,t)}},ie=class extends r{constructor([e],t){let s=["flushdb"];e?.async&&s.push("async"),super(s,t)}},re=class extends r{constructor([e],t){super(["function","delete",e],t)}},ce=class extends r{constructor(e){super(["function","flush"],e)}},oe=class extends r{constructor([e],t){let s=["function","list"];e?.libraryName&&s.push("libraryname",e.libraryName),e?.withCode&&s.push("withcode"),super(s,{deserialize:fn,...t})}};function fn(e){return Array.isArray(e)?e.map(t=>{let s=m(t),n=s.functions.map(i=>m(i));return{libraryName:s.library_name,engine:s.engine,functions:n.map(i=>({name:i.name,description:i.description??void 0,flags:i.flags})),libraryCode:s.library_code}}):[]}var he=class extends r{constructor([e],t){super(["function","load",...e.replace?["replace"]:[],e.code],t)}},ae=class extends r{constructor(e){super(["function","stats"],{deserialize:bn,...e})}};function bn(e){return{engines:Object.fromEntries(Object.entries(Object.fromEntries(Object.entries(m(m(e).engines)).map(([t,s])=>[t,m(s)]))).map(([t,s])=>[t,{librariesCount:s.libraries_count,functionsCount:s.functions_count}]))}}var pe=class extends r{constructor([e,t,...s],n){let i=["geoadd",e];"nx"in t&&t.nx?i.push("nx"):"xx"in t&&t.xx&&i.push("xx"),"ch"in t&&t.ch&&i.push("ch"),"latitude"in t&&t.latitude&&i.push(t.longitude,t.latitude,t.member),i.push(...s.flatMap(({latitude:c,longitude:o,member:a})=>[o,c,a])),super(i,n)}},le=class extends r{constructor([e,t,s,n="M"],i){super(["GEODIST",e,t,s,n],i)}},ue=class extends r{constructor(e,t){let[s]=e;super(["GEOHASH",s,...Array.isArray(e[1])?e[1]:e.slice(1)],t)}},me=class extends r{constructor(e,t){let[s]=e;super(["GEOPOS",s,...Array.isArray(e[1])?e[1]:e.slice(1)],{deserialize:n=>function(i){let c=[];for(let o of i)o?.[0]&&o?.[1]&&c.push({lng:Number.parseFloat(o[0]),lat:Number.parseFloat(o[1])});return c}(n),...t})}},de=class extends r{constructor([e,t,s,n,i],c){let o=["GEOSEARCH",e];(t.type==="FROMMEMBER"||t.type==="frommember")&&o.push(t.type,t.member),(t.type==="FROMLONLAT"||t.type==="fromlonlat")&&o.push(t.type,t.coordinate.lon,t.coordinate.lat),(s.type==="BYRADIUS"||s.type==="byradius")&&o.push(s.type,s.radius,s.radiusType),(s.type==="BYBOX"||s.type==="bybox")&&o.push(s.type,s.rect.width,s.rect.height,s.rectType),o.push(n),i?.count&&o.push("COUNT",i.count.limit,...i.count.any?["ANY"]:[]),super([...o,...i?.withCoord?["WITHCOORD"]:[],...i?.withDist?["WITHDIST"]:[],...i?.withHash?["WITHHASH"]:[]],{deserialize:a=>i?.withCoord||i?.withDist||i?.withHash?a.map(h=>{let x=1,w={};try{w.member=JSON.parse(h[0])}catch{w.member=h[0]}return i.withDist&&(w.dist=Number.parseFloat(h[x++])),i.withHash&&(w.hash=h[x++].toString()),i.withCoord&&(w.coord={long:Number.parseFloat(h[x][0]),lat:Number.parseFloat(h[x][1])}),w}):a.map(h=>{try{return{member:JSON.parse(h)}}catch{return{member:h}}}),...c})}},xe=class extends r{constructor([e,t,s,n,i,c],o){let a=["GEOSEARCHSTORE",e,t];(s.type==="FROMMEMBER"||s.type==="frommember")&&a.push(s.type,s.member),(s.type==="FROMLONLAT"||s.type==="fromlonlat")&&a.push(s.type,s.coordinate.lon,s.coordinate.lat),(n.type==="BYRADIUS"||n.type==="byradius")&&a.push(n.type,n.radius,n.radiusType),(n.type==="BYBOX"||n.type==="bybox")&&a.push(n.type,n.rect.width,n.rect.height,n.rectType),a.push(i),c?.count&&a.push("COUNT",c.count.limit,...c.count.any?["ANY"]:[]),super([...a,...c?.storeDist?["STOREDIST"]:[]],o)}},we=class extends r{constructor(e,t){super(["get",...e],t)}},ge=class extends r{constructor(e,t){super(["getbit",...e],t)}},ye=class extends r{constructor(e,t){super(["getdel",...e],t)}},Oe=class extends r{constructor([e,t],s){let n=["getex",e];t&&("ex"in t&&typeof t.ex=="number"?n.push("ex",t.ex):"px"in t&&typeof t.px=="number"?n.push("px",t.px):"exat"in t&&typeof t.exat=="number"?n.push("exat",t.exat):"pxat"in t&&typeof t.pxat=="number"?n.push("pxat",t.pxat):"persist"in t&&t.persist&&n.push("persist")),super(n,s)}},fe=class extends r{constructor(e,t){super(["getrange",...e],t)}},be=class extends r{constructor(e,t){super(["getset",...e],t)}},Ee=class extends r{constructor(e,t){super(["hdel",...e],t)}},Se=class extends r{constructor(e,t){super(["hexists",...e],t)}},Ae=class extends r{constructor(e,t){let[s,n,i,c]=e,o=Array.isArray(n)?n:[n];super(["hexpire",s,i,...c?[c]:[],"FIELDS",o.length,...o],t)}},Te=class extends r{constructor(e,t){let[s,n,i,c]=e,o=Array.isArray(n)?n:[n];super(["hexpireat",s,i,...c?[c]:[],"FIELDS",o.length,...o],t)}},Re=class extends r{constructor(e,t){let[s,n]=e,i=Array.isArray(n)?n:[n];super(["hexpiretime",s,"FIELDS",i.length,...i],t)}},ve=class extends r{constructor(e,t){let[s,n]=e,i=Array.isArray(n)?n:[n];super(["hpersist",s,"FIELDS",i.length,...i],t)}},Ne=class extends r{constructor(e,t){let[s,n,i,c]=e,o=Array.isArray(n)?n:[n];super(["hpexpire",s,i,...c?[c]:[],"FIELDS",o.length,...o],t)}},ze=class extends r{constructor(e,t){let[s,n,i,c]=e,o=Array.isArray(n)?n:[n];super(["hpexpireat",s,i,...c?[c]:[],"FIELDS",o.length,...o],t)}},ke=class extends r{constructor(e,t){let[s,n]=e,i=Array.isArray(n)?n:[n];super(["hpexpiretime",s,"FIELDS",i.length,...i],t)}},Ie=class extends r{constructor(e,t){let[s,n]=e,i=Array.isArray(n)?n:[n];super(["hpttl",s,"FIELDS",i.length,...i],t)}},Ce=class extends r{constructor(e,t){super(["hget",...e],t)}},Ue=class extends r{constructor(e,t){super(["hgetall",...e],{deserialize:s=>function(n){if(n.length===0)return null;let i={};for(let c=0;c<n.length;c+=2){let o=n[c],a=n[c+1];try{let h=!Number.isNaN(Number(a))&&!Number.isSafeInteger(Number(a));i[o]=h?a:JSON.parse(a)}catch{i[o]=a}}return i}(s),...t})}},Me=class extends r{constructor(e,t){super(["hincrby",...e],t)}},Pe=class extends r{constructor(e,t){super(["hincrbyfloat",...e],t)}},Le=class extends r{constructor([e],t){super(["hkeys",e],t)}},De=class extends r{constructor(e,t){super(["hlen",...e],t)}},Je=class extends r{constructor([e,...t],s){super(["hmget",e,...t],{deserialize:n=>function(i,c){if(c.every(a=>a===null))return null;let o={};for(let[a,h]of i.entries())try{o[h]=JSON.parse(c[a])}catch{o[h]=c[a]}return o}(t,n),...s})}},_e=class extends r{constructor([e,t],s){super(["hmset",e,...Object.entries(t).flatMap(([n,i])=>[n,i])],s)}},je=class extends r{constructor([e,t,s],n){let i=["hscan",e,t];s?.match&&i.push("match",s.match),typeof s?.count=="number"&&i.push("count",s.count),super(i,{deserialize:l,...n})}},$e=class extends r{constructor([e,t],s){super(["hset",e,...Object.entries(t).flatMap(([n,i])=>[n,i])],s)}},Fe=class extends r{constructor(e,t){super(["hsetnx",...e],t)}},Ye=class extends r{constructor(e,t){super(["hstrlen",...e],t)}},Ge=class extends r{constructor(e,t){let[s,n]=e,i=Array.isArray(n)?n:[n];super(["httl",s,"FIELDS",i.length,...i],t)}},Xe=class extends r{constructor(e,t){super(["hvals",...e],t)}},Be=class extends r{constructor(e,t){super(["incr",...e],t)}},We=class extends r{constructor(e,t){super(["incrby",...e],t)}},He=class extends r{constructor(e,t){super(["incrbyfloat",...e],t)}},Ke=class extends r{constructor(e,t){super(["JSON.ARRAPPEND",...e],t)}},Ve=class extends r{constructor(e,t){super(["JSON.ARRINDEX",...e],t)}},qe=class extends r{constructor(e,t){super(["JSON.ARRINSERT",...e],t)}},Ze=class extends r{constructor(e,t){super(["JSON.ARRLEN",e[0],e[1]??"$"],t)}},Qe=class extends r{constructor(e,t){super(["JSON.ARRPOP",...e],t)}},et=class extends r{constructor(e,t){let s=e[1]??"$";super(["JSON.ARRTRIM",e[0],s,e[2]??0,e[3]??0],t)}},tt=class extends r{constructor(e,t){super(["JSON.CLEAR",...e],t)}},st=class extends r{constructor(e,t){super(["JSON.DEL",...e],t)}},nt=class extends r{constructor(e,t){super(["JSON.FORGET",...e],t)}},it=class extends r{constructor(e,t){let s=["JSON.GET"];typeof e[1]=="string"?s.push(...e):(s.push(e[0]),e[1]&&(e[1].indent&&s.push("INDENT",e[1].indent),e[1].newline&&s.push("NEWLINE",e[1].newline),e[1].space&&s.push("SPACE",e[1].space)),s.push(...e.slice(2))),super(s,t)}},rt=class extends r{constructor(e,t){super(["JSON.MERGE",...e],t)}},ct=class extends r{constructor(e,t){super(["JSON.MGET",...e[0],e[1]],t)}},ot=class extends r{constructor(e,t){let s=["JSON.MSET"];for(let n of e)s.push(n.key,n.path,n.value);super(s,t)}},ht=class extends r{constructor(e,t){super(["JSON.NUMINCRBY",...e],t)}},at=class extends r{constructor(e,t){super(["JSON.NUMMULTBY",...e],t)}},pt=class extends r{constructor(e,t){super(["JSON.OBJKEYS",...e],t)}},lt=class extends r{constructor(e,t){super(["JSON.OBJLEN",...e],t)}},ut=class extends r{constructor(e,t){super(["JSON.RESP",...e],t)}},mt=class extends r{constructor(e,t){let s=["JSON.SET",e[0],e[1],e[2]];e[3]&&(e[3].nx?s.push("NX"):e[3].xx&&s.push("XX")),super(s,t)}},dt=class extends r{constructor(e,t){super(["JSON.STRAPPEND",...e],t)}},xt=class extends r{constructor(e,t){super(["JSON.STRLEN",...e],t)}},wt=class extends r{constructor(e,t){super(["JSON.TOGGLE",...e],t)}},gt=class extends r{constructor(e,t){super(["JSON.TYPE",...e],t)}},yt=class extends r{constructor(e,t){super(["keys",...e],t)}},Ot=class extends r{constructor(e,t){super(["lindex",...e],t)}},ft=class extends r{constructor(e,t){super(["linsert",...e],t)}},bt=class extends r{constructor(e,t){super(["llen",...e],t)}},Et=class extends r{constructor(e,t){super(["lmove",...e],t)}},St=class extends r{constructor(e,t){let[s,n,i,c]=e;super(["LMPOP",s,...n,i,...c?["COUNT",c]:[]],t)}},At=class extends r{constructor(e,t){super(["lpop",...e],t)}},Tt=class extends r{constructor(e,t){let s=["lpos",e[0],e[1]];typeof e[2]?.rank=="number"&&s.push("rank",e[2].rank),typeof e[2]?.count=="number"&&s.push("count",e[2].count),typeof e[2]?.maxLen=="number"&&s.push("maxLen",e[2].maxLen),super(s,t)}},Rt=class extends r{constructor(e,t){super(["lpush",...e],t)}},vt=class extends r{constructor(e,t){super(["lpushx",...e],t)}},Nt=class extends r{constructor(e,t){super(["lrange",...e],t)}},zt=class extends r{constructor(e,t){super(["lrem",...e],t)}},kt=class extends r{constructor(e,t){super(["lset",...e],t)}},It=class extends r{constructor(e,t){super(["ltrim",...e],t)}},Ct=class extends r{constructor(e,t){super(["mget",...Array.isArray(e[0])?e[0]:e],t)}},Ut=class extends r{constructor([e],t){super(["mset",...Object.entries(e).flatMap(([s,n])=>[s,n])],t)}},Mt=class extends r{constructor([e],t){super(["msetnx",...Object.entries(e).flat()],t)}},Pt=class extends r{constructor(e,t){super(["persist",...e],t)}},Lt=class extends r{constructor(e,t){super(["pexpire",...e],t)}},Dt=class extends r{constructor(e,t){super(["pexpireat",...e],t)}},Jt=class extends r{constructor(e,t){super(["pfadd",...e],t)}},_t=class extends r{constructor(e,t){super(["pfcount",...e],t)}},jt=class extends r{constructor(e,t){super(["pfmerge",...e],t)}},$t=class extends r{constructor(e,t){let s=["ping"];e?.[0]!==void 0&&s.push(e[0]),super(s,t)}},Ft=class extends r{constructor(e,t){super(["psetex",...e],t)}},Yt=class extends r{constructor(e,t){super(["pttl",...e],t)}},Gt=class extends r{constructor(e,t){super(["publish",...e],t)}},Xt=class extends r{constructor(e){super(["randomkey"],e)}},Bt=class extends r{constructor(e,t){super(["rename",...e],t)}},Wt=class extends r{constructor(e,t){super(["renamenx",...e],t)}},Ht=class extends r{constructor(e,t){super(["rpop",...e],t)}},Kt=class extends r{constructor(e,t){super(["rpush",...e],t)}},Vt=class extends r{constructor(e,t){super(["rpushx",...e],t)}},qt=class extends r{constructor(e,t){super(["sadd",...e],t)}},Zt=class extends r{constructor([e,t],s){let n=["scan",e];t?.match&&n.push("match",t.match),typeof t?.count=="number"&&n.push("count",t.count),t&&"withType"in t&&t.withType===!0?n.push("withtype"):t&&"type"in t&&t.type&&t.type.length>0&&n.push("type",t.type),super(n,{deserialize:t?.withType?d:l,...s})}},Qt=class extends r{constructor(e,t){super(["scard",...e],t)}},es=class extends r{constructor(e,t){super(["script","exists",...e],{deserialize:s=>s,...t})}},ts=class extends r{constructor([e],t){let s=["script","flush"];e?.sync?s.push("sync"):e?.async&&s.push("async"),super(s,t)}},ss=class extends r{constructor(e,t){super(["script","load",...e],t)}},ns=class extends r{constructor(e,t){super(["sdiff",...e],t)}},is=class extends r{constructor(e,t){super(["sdiffstore",...e],t)}},rs=class extends r{constructor([e,t,s],n){let i=["set",e,t];s&&("nx"in s&&s.nx?i.push("nx"):"xx"in s&&s.xx&&i.push("xx"),"get"in s&&s.get&&i.push("get"),"ex"in s&&typeof s.ex=="number"?i.push("ex",s.ex):"px"in s&&typeof s.px=="number"?i.push("px",s.px):"exat"in s&&typeof s.exat=="number"?i.push("exat",s.exat):"pxat"in s&&typeof s.pxat=="number"?i.push("pxat",s.pxat):"keepTtl"in s&&s.keepTtl&&i.push("keepTtl")),super(i,n)}},cs=class extends r{constructor(e,t){super(["setbit",...e],t)}},os=class extends r{constructor(e,t){super(["setex",...e],t)}},hs=class extends r{constructor(e,t){super(["setnx",...e],t)}},as=class extends r{constructor(e,t){super(["setrange",...e],t)}},ps=class extends r{constructor(e,t){super(["sinter",...e],t)}},ls=class extends r{constructor(e,t){super(["sinterstore",...e],t)}},us=class extends r{constructor(e,t){super(["sismember",...e],t)}},ms=class extends r{constructor(e,t){super(["smembers",...e],t)}},ds=class extends r{constructor(e,t){super(["smismember",e[0],...e[1]],t)}},xs=class extends r{constructor(e,t){super(["smove",...e],t)}},ws=class extends r{constructor([e,t],s){let n=["spop",e];typeof t=="number"&&n.push(t),super(n,s)}},gs=class extends r{constructor([e,t],s){let n=["srandmember",e];typeof t=="number"&&n.push(t),super(n,s)}},ys=class extends r{constructor(e,t){super(["srem",...e],t)}},Os=class extends r{constructor([e,t,s],n){let i=["sscan",e,t];s?.match&&i.push("match",s.match),typeof s?.count=="number"&&i.push("count",s.count),super(i,{deserialize:l,...n})}},fs=class extends r{constructor(e,t){super(["strlen",...e],t)}},bs=class extends r{constructor(e,t){super(["sunion",...e],t)}},Es=class extends r{constructor(e,t){super(["sunionstore",...e],t)}},Ss=class extends r{constructor(e){super(["time"],e)}},As=class extends r{constructor(e,t){super(["touch",...e],t)}},Ts=class extends r{constructor(e,t){super(["ttl",...e],t)}},Rs=class extends r{constructor(e,t){super(["type",...e],t)}},vs=class extends r{constructor(e,t){super(["unlink",...e],t)}},Ns=class extends r{constructor([e,t,s],n){super(["XACK",e,t,...Array.isArray(s)?[...s]:[s]],n)}},zs=class extends r{constructor([e,t,s,n],i){let c=["XADD",e];for(let[o,a]of(n&&(n.nomkStream&&c.push("NOMKSTREAM"),n.trim&&(c.push(n.trim.type,n.trim.comparison,n.trim.threshold),n.trim.limit!==void 0&&c.push("LIMIT",n.trim.limit))),c.push(t),Object.entries(s)))c.push(o,a);super(c,i)}},ks=class extends r{constructor([e,t,s,n,i,c],o){let a=[];c?.count&&a.push("COUNT",c.count),c?.justId&&a.push("JUSTID"),super(["XAUTOCLAIM",e,t,s,n,i,...a],o)}},Is=class extends r{constructor([e,t,s,n,i,c],o){let a=Array.isArray(i)?[...i]:[i],h=[];c?.idleMS&&h.push("IDLE",c.idleMS),c?.idleMS&&h.push("TIME",c.timeMS),c?.retryCount&&h.push("RETRYCOUNT",c.retryCount),c?.force&&h.push("FORCE"),c?.justId&&h.push("JUSTID"),c?.lastId&&h.push("LASTID",c.lastId),super(["XCLAIM",e,t,s,n,...a,...h],o)}},Cs=class extends r{constructor([e,t],s){super(["XDEL",e,...Array.isArray(t)?[...t]:[t]],s)}},Us=class extends r{constructor([e,t],s){let n=["XGROUP"];switch(t.type){case"CREATE":n.push("CREATE",e,t.group,t.id),t.options&&(t.options.MKSTREAM&&n.push("MKSTREAM"),t.options.ENTRIESREAD!==void 0&&n.push("ENTRIESREAD",t.options.ENTRIESREAD.toString()));break;case"CREATECONSUMER":n.push("CREATECONSUMER",e,t.group,t.consumer);break;case"DELCONSUMER":n.push("DELCONSUMER",e,t.group,t.consumer);break;case"DESTROY":n.push("DESTROY",e,t.group);break;case"SETID":n.push("SETID",e,t.group,t.id),t.options?.ENTRIESREAD!==void 0&&n.push("ENTRIESREAD",t.options.ENTRIESREAD.toString());break;default:throw Error("Invalid XGROUP")}super(n,s)}},Ms=class extends r{constructor([e,t],s){let n=[];t.type==="CONSUMERS"?n.push("CONSUMERS",e,t.group):n.push("GROUPS",e),super(["XINFO",...n],s)}},Ps=class extends r{constructor(e,t){super(["XLEN",...e],t)}},Ls=class extends r{constructor([e,t,s,n,i,c],o){super(["XPENDING",e,t,...c?.idleTime?["IDLE",c.idleTime]:[],s,n,i,...c?.consumer===void 0?[]:Array.isArray(c.consumer)?[...c.consumer]:[c.consumer]],o)}},Ds=class extends r{constructor([e,t,s,n],i){let c=["XRANGE",e,t,s];typeof n=="number"&&c.push("COUNT",n),super(c,{deserialize:o=>function(a){let h={};for(let x of a)for(let w=0;w<x.length;w+=2){let u=x[w],y=x[w+1];u in h||(h[u]={});for(let g=0;g<y.length;g+=2){let b=y[g],f=y[g+1];try{h[u][b]=JSON.parse(f)}catch{h[u][b]=f}}}return h}(o),...i})}},Js=class extends r{constructor([e,t,s],n){if(Array.isArray(e)&&Array.isArray(t)&&e.length!==t.length)throw Error("ERR Unbalanced XREAD list of streams: for each stream key an ID or '$' must be specified");let i=[];typeof s?.count=="number"&&i.push("COUNT",s.count),typeof s?.blockMS=="number"&&i.push("BLOCK",s.blockMS),i.push("STREAMS",...Array.isArray(e)?[...e]:[e],...Array.isArray(t)?[...t]:[t]),super(["XREAD",...i],n)}},_s=class extends r{constructor([e,t,s,n,i],c){if(Array.isArray(s)&&Array.isArray(n)&&s.length!==n.length)throw Error("ERR Unbalanced XREADGROUP list of streams: for each stream key an ID or '$' must be specified");let o=[];typeof i?.count=="number"&&o.push("COUNT",i.count),typeof i?.blockMS=="number"&&o.push("BLOCK",i.blockMS),typeof i?.NOACK=="boolean"&&i.NOACK&&o.push("NOACK"),o.push("STREAMS",...Array.isArray(s)?[...s]:[s],...Array.isArray(n)?[...n]:[n]),super(["XREADGROUP","GROUP",e,t,...o],c)}},js=class extends r{constructor([e,t,s,n],i){let c=["XREVRANGE",e,t,s];typeof n=="number"&&c.push("COUNT",n),super(c,{deserialize:o=>function(a){let h={};for(let x of a)for(let w=0;w<x.length;w+=2){let u=x[w],y=x[w+1];u in h||(h[u]={});for(let g=0;g<y.length;g+=2){let b=y[g],f=y[g+1];try{h[u][b]=JSON.parse(f)}catch{h[u][b]=f}}}return h}(o),...i})}},$s=class extends r{constructor([e,t],s){let{limit:n,strategy:i,threshold:c,exactness:o="~"}=t;super(["XTRIM",e,i,o,c,...n?["LIMIT",n]:[]],s)}},Fs=class extends r{constructor([e,t,...s],n){let i=["zadd",e];"nx"in t&&t.nx?i.push("nx"):"xx"in t&&t.xx&&i.push("xx"),"ch"in t&&t.ch&&i.push("ch"),"incr"in t&&t.incr&&i.push("incr"),"lt"in t&&t.lt?i.push("lt"):"gt"in t&&t.gt&&i.push("gt"),"score"in t&&"member"in t&&i.push(t.score,t.member),i.push(...s.flatMap(({score:c,member:o})=>[c,o])),super(i,n)}},Ys=class extends r{constructor(e,t){super(["zcard",...e],t)}},Gs=class extends r{constructor(e,t){super(["zcount",...e],t)}},Xs=class extends r{constructor(e,t){super(["zincrby",...e],t)}},Bs=class extends r{constructor([e,t,s,n],i){let c=["zinterstore",e,t];Array.isArray(s)?c.push(...s):c.push(s),n&&("weights"in n&&n.weights?c.push("weights",...n.weights):"weight"in n&&typeof n.weight=="number"&&c.push("weights",n.weight),"aggregate"in n&&c.push("aggregate",n.aggregate)),super(c,i)}},Ws=class extends r{constructor(e,t){super(["zlexcount",...e],t)}},Hs=class extends r{constructor([e,t],s){let n=["zpopmax",e];typeof t=="number"&&n.push(t),super(n,s)}},Ks=class extends r{constructor([e,t],s){let n=["zpopmin",e];typeof t=="number"&&n.push(t),super(n,s)}},Vs=class extends r{constructor([e,t,s,n],i){let c=["zrange",e,t,s];n?.byScore&&c.push("byscore"),n?.byLex&&c.push("bylex"),n?.rev&&c.push("rev"),n?.count!==void 0&&n.offset!==void 0&&c.push("limit",n.offset,n.count),n?.withScores&&c.push("withscores"),super(c,i)}},qs=class extends r{constructor(e,t){super(["zrank",...e],t)}},Zs=class extends r{constructor(e,t){super(["zrem",...e],t)}},Qs=class extends r{constructor(e,t){super(["zremrangebylex",...e],t)}},en=class extends r{constructor(e,t){super(["zremrangebyrank",...e],t)}},tn=class extends r{constructor(e,t){super(["zremrangebyscore",...e],t)}},sn=class extends r{constructor(e,t){super(["zrevrank",...e],t)}},nn=class extends r{constructor([e,t,s],n){let i=["zscan",e,t];s?.match&&i.push("match",s.match),typeof s?.count=="number"&&i.push("count",s.count),super(i,{deserialize:l,...n})}},rn=class extends r{constructor(e,t){super(["zscore",...e],t)}},cn=class extends r{constructor([e,t,s],n){let i=["zunion",e];Array.isArray(t)?i.push(...t):i.push(t),s&&("weights"in s&&s.weights?i.push("weights",...s.weights):"weight"in s&&typeof s.weight=="number"&&i.push("weights",s.weight),"aggregate"in s&&i.push("aggregate",s.aggregate),s.withScores&&i.push("withscores")),super(i,n)}},on=class extends r{constructor([e,t,s,n],i){let c=["zunionstore",e,t];Array.isArray(s)?c.push(...s):c.push(s),n&&("weights"in n&&n.weights?c.push("weights",...n.weights):"weight"in n&&typeof n.weight=="number"&&c.push("weights",n.weight),"aggregate"in n&&c.push("aggregate",n.aggregate)),super(c,i)}},hn=class extends r{constructor(e,t){super(["zdiffstore",...e],t)}},an=class extends r{constructor(e,t){let[s,n]=e;super(["zmscore",s,...n],t)}},pn=class{client;commands;commandOptions;multiExec;constructor(e){if(this.client=e.client,this.commands=[],this.commandOptions=e.commandOptions,this.multiExec=e.multiExec??!1,this.commandOptions?.latencyLogging){let t=this.exec.bind(this);this.exec=async s=>{let n=performance.now(),i=await(s?t(s):t()),c=(performance.now()-n).toFixed(2);return console.log(`Latency for \x1B[38;2;19;185;39m${this.multiExec?["MULTI-EXEC"]:["PIPELINE"].toString().toUpperCase()}\x1B[0m: \x1B[38;2;0;255;255m${c} ms\x1B[0m`),i}}}exec=async e=>{if(this.commands.length===0)throw Error("Pipeline is empty");let t=this.multiExec?["multi-exec"]:["pipeline"],s=await this.client.request({path:t,body:Object.values(this.commands).map(n=>n.command)});return e?.keepErrors?s.map(({error:n,result:i},c)=>({error:n,result:this.commands[c].deserialize(i)})):s.map(({error:n,result:i},c)=>{if(n)throw new E(`Command ${c+1} [ ${this.commands[c].command[0]} ] failed: ${n}`);return this.commands[c].deserialize(i)})};length(){return this.commands.length}chain(e){return this.commands.push(e),this}append=(...e)=>this.chain(new D(e,this.commandOptions));bitcount=(...e)=>this.chain(new J(e,this.commandOptions));bitfield=(...e)=>new _(e,this.client,this.commandOptions,this.chain.bind(this));bitop=(e,t,s,...n)=>this.chain(new j([e,t,s,...n],this.commandOptions));bitpos=(...e)=>this.chain(new $(e,this.commandOptions));copy=(...e)=>this.chain(new F(e,this.commandOptions));zdiffstore=(...e)=>this.chain(new hn(e,this.commandOptions));dbsize=()=>this.chain(new Y(this.commandOptions));decr=(...e)=>this.chain(new G(e,this.commandOptions));decrby=(...e)=>this.chain(new X(e,this.commandOptions));del=(...e)=>this.chain(new B(e,this.commandOptions));echo=(...e)=>this.chain(new W(e,this.commandOptions));evalRo=(...e)=>this.chain(new H(e,this.commandOptions));eval=(...e)=>this.chain(new K(e,this.commandOptions));evalshaRo=(...e)=>this.chain(new V(e,this.commandOptions));evalsha=(...e)=>this.chain(new q(e,this.commandOptions));exists=(...e)=>this.chain(new Z(e,this.commandOptions));expire=(...e)=>this.chain(new Q(e,this.commandOptions));expireat=(...e)=>this.chain(new ee(e,this.commandOptions));flushall=e=>this.chain(new ne(e,this.commandOptions));flushdb=(...e)=>this.chain(new ie(e,this.commandOptions));geoadd=(...e)=>this.chain(new pe(e,this.commandOptions));geodist=(...e)=>this.chain(new le(e,this.commandOptions));geopos=(...e)=>this.chain(new me(e,this.commandOptions));geohash=(...e)=>this.chain(new ue(e,this.commandOptions));geosearch=(...e)=>this.chain(new de(e,this.commandOptions));geosearchstore=(...e)=>this.chain(new xe(e,this.commandOptions));get=(...e)=>this.chain(new we(e,this.commandOptions));getbit=(...e)=>this.chain(new ge(e,this.commandOptions));getdel=(...e)=>this.chain(new ye(e,this.commandOptions));getex=(...e)=>this.chain(new Oe(e,this.commandOptions));getrange=(...e)=>this.chain(new fe(e,this.commandOptions));getset=(e,t)=>this.chain(new be([e,t],this.commandOptions));hdel=(...e)=>this.chain(new Ee(e,this.commandOptions));hexists=(...e)=>this.chain(new Se(e,this.commandOptions));hexpire=(...e)=>this.chain(new Ae(e,this.commandOptions));hexpireat=(...e)=>this.chain(new Te(e,this.commandOptions));hexpiretime=(...e)=>this.chain(new Re(e,this.commandOptions));httl=(...e)=>this.chain(new Ge(e,this.commandOptions));hpexpire=(...e)=>this.chain(new Ne(e,this.commandOptions));hpexpireat=(...e)=>this.chain(new ze(e,this.commandOptions));hpexpiretime=(...e)=>this.chain(new ke(e,this.commandOptions));hpttl=(...e)=>this.chain(new Ie(e,this.commandOptions));hpersist=(...e)=>this.chain(new ve(e,this.commandOptions));hget=(...e)=>this.chain(new Ce(e,this.commandOptions));hgetall=(...e)=>this.chain(new Ue(e,this.commandOptions));hincrby=(...e)=>this.chain(new Me(e,this.commandOptions));hincrbyfloat=(...e)=>this.chain(new Pe(e,this.commandOptions));hkeys=(...e)=>this.chain(new Le(e,this.commandOptions));hlen=(...e)=>this.chain(new De(e,this.commandOptions));hmget=(...e)=>this.chain(new Je(e,this.commandOptions));hmset=(e,t)=>this.chain(new _e([e,t],this.commandOptions));hrandfield=(e,t,s)=>this.chain(new L([e,t,s],this.commandOptions));hscan=(...e)=>this.chain(new je(e,this.commandOptions));hset=(e,t)=>this.chain(new $e([e,t],this.commandOptions));hsetnx=(e,t,s)=>this.chain(new Fe([e,t,s],this.commandOptions));hstrlen=(...e)=>this.chain(new Ye(e,this.commandOptions));hvals=(...e)=>this.chain(new Xe(e,this.commandOptions));incr=(...e)=>this.chain(new Be(e,this.commandOptions));incrby=(...e)=>this.chain(new We(e,this.commandOptions));incrbyfloat=(...e)=>this.chain(new He(e,this.commandOptions));keys=(...e)=>this.chain(new yt(e,this.commandOptions));lindex=(...e)=>this.chain(new Ot(e,this.commandOptions));linsert=(e,t,s,n)=>this.chain(new ft([e,t,s,n],this.commandOptions));llen=(...e)=>this.chain(new bt(e,this.commandOptions));lmove=(...e)=>this.chain(new Et(e,this.commandOptions));lpop=(...e)=>this.chain(new At(e,this.commandOptions));lmpop=(...e)=>this.chain(new St(e,this.commandOptions));lpos=(...e)=>this.chain(new Tt(e,this.commandOptions));lpush=(e,...t)=>this.chain(new Rt([e,...t],this.commandOptions));lpushx=(e,...t)=>this.chain(new vt([e,...t],this.commandOptions));lrange=(...e)=>this.chain(new Nt(e,this.commandOptions));lrem=(e,t,s)=>this.chain(new zt([e,t,s],this.commandOptions));lset=(e,t,s)=>this.chain(new kt([e,t,s],this.commandOptions));ltrim=(...e)=>this.chain(new It(e,this.commandOptions));mget=(...e)=>this.chain(new Ct(e,this.commandOptions));mset=e=>this.chain(new Ut([e],this.commandOptions));msetnx=e=>this.chain(new Mt([e],this.commandOptions));persist=(...e)=>this.chain(new Pt(e,this.commandOptions));pexpire=(...e)=>this.chain(new Lt(e,this.commandOptions));pexpireat=(...e)=>this.chain(new Dt(e,this.commandOptions));pfadd=(...e)=>this.chain(new Jt(e,this.commandOptions));pfcount=(...e)=>this.chain(new _t(e,this.commandOptions));pfmerge=(...e)=>this.chain(new jt(e,this.commandOptions));ping=e=>this.chain(new $t(e,this.commandOptions));psetex=(e,t,s)=>this.chain(new Ft([e,t,s],this.commandOptions));pttl=(...e)=>this.chain(new Yt(e,this.commandOptions));publish=(...e)=>this.chain(new Gt(e,this.commandOptions));randomkey=()=>this.chain(new Xt(this.commandOptions));rename=(...e)=>this.chain(new Bt(e,this.commandOptions));renamenx=(...e)=>this.chain(new Wt(e,this.commandOptions));rpop=(...e)=>this.chain(new Ht(e,this.commandOptions));rpush=(e,...t)=>this.chain(new Kt([e,...t],this.commandOptions));rpushx=(e,...t)=>this.chain(new Vt([e,...t],this.commandOptions));sadd=(e,t,...s)=>this.chain(new qt([e,t,...s],this.commandOptions));scan=(...e)=>this.chain(new Zt(e,this.commandOptions));scard=(...e)=>this.chain(new Qt(e,this.commandOptions));scriptExists=(...e)=>this.chain(new es(e,this.commandOptions));scriptFlush=(...e)=>this.chain(new ts(e,this.commandOptions));scriptLoad=(...e)=>this.chain(new ss(e,this.commandOptions));sdiff=(...e)=>this.chain(new ns(e,this.commandOptions));sdiffstore=(...e)=>this.chain(new is(e,this.commandOptions));set=(e,t,s)=>this.chain(new rs([e,t,s],this.commandOptions));setbit=(...e)=>this.chain(new cs(e,this.commandOptions));setex=(e,t,s)=>this.chain(new os([e,t,s],this.commandOptions));setnx=(e,t)=>this.chain(new hs([e,t],this.commandOptions));setrange=(...e)=>this.chain(new as(e,this.commandOptions));sinter=(...e)=>this.chain(new ps(e,this.commandOptions));sinterstore=(...e)=>this.chain(new ls(e,this.commandOptions));sismember=(e,t)=>this.chain(new us([e,t],this.commandOptions));smembers=(...e)=>this.chain(new ms(e,this.commandOptions));smismember=(e,t)=>this.chain(new ds([e,t],this.commandOptions));smove=(e,t,s)=>this.chain(new xs([e,t,s],this.commandOptions));spop=(...e)=>this.chain(new ws(e,this.commandOptions));srandmember=(...e)=>this.chain(new gs(e,this.commandOptions));srem=(e,...t)=>this.chain(new ys([e,...t],this.commandOptions));sscan=(...e)=>this.chain(new Os(e,this.commandOptions));strlen=(...e)=>this.chain(new fs(e,this.commandOptions));sunion=(...e)=>this.chain(new bs(e,this.commandOptions));sunionstore=(...e)=>this.chain(new Es(e,this.commandOptions));time=()=>this.chain(new Ss(this.commandOptions));touch=(...e)=>this.chain(new As(e,this.commandOptions));ttl=(...e)=>this.chain(new Ts(e,this.commandOptions));type=(...e)=>this.chain(new Rs(e,this.commandOptions));unlink=(...e)=>this.chain(new vs(e,this.commandOptions));zadd=(...e)=>("score"in e[1],this.chain(new Fs([e[0],e[1],...e.slice(2)],this.commandOptions)));xadd=(...e)=>this.chain(new zs(e,this.commandOptions));xack=(...e)=>this.chain(new Ns(e,this.commandOptions));xdel=(...e)=>this.chain(new Cs(e,this.commandOptions));xgroup=(...e)=>this.chain(new Us(e,this.commandOptions));xread=(...e)=>this.chain(new Js(e,this.commandOptions));xreadgroup=(...e)=>this.chain(new _s(e,this.commandOptions));xinfo=(...e)=>this.chain(new Ms(e,this.commandOptions));xlen=(...e)=>this.chain(new Ps(e,this.commandOptions));xpending=(...e)=>this.chain(new Ls(e,this.commandOptions));xclaim=(...e)=>this.chain(new Is(e,this.commandOptions));xautoclaim=(...e)=>this.chain(new ks(e,this.commandOptions));xtrim=(...e)=>this.chain(new $s(e,this.commandOptions));xrange=(...e)=>this.chain(new Ds(e,this.commandOptions));xrevrange=(...e)=>this.chain(new js(e,this.commandOptions));zcard=(...e)=>this.chain(new Ys(e,this.commandOptions));zcount=(...e)=>this.chain(new Gs(e,this.commandOptions));zincrby=(e,t,s)=>this.chain(new Xs([e,t,s],this.commandOptions));zinterstore=(...e)=>this.chain(new Bs(e,this.commandOptions));zlexcount=(...e)=>this.chain(new Ws(e,this.commandOptions));zmscore=(...e)=>this.chain(new an(e,this.commandOptions));zpopmax=(...e)=>this.chain(new Hs(e,this.commandOptions));zpopmin=(...e)=>this.chain(new Ks(e,this.commandOptions));zrange=(...e)=>this.chain(new Vs(e,this.commandOptions));zrank=(e,t)=>this.chain(new qs([e,t],this.commandOptions));zrem=(e,...t)=>this.chain(new Zs([e,...t],this.commandOptions));zremrangebylex=(...e)=>this.chain(new Qs(e,this.commandOptions));zremrangebyrank=(...e)=>this.chain(new en(e,this.commandOptions));zremrangebyscore=(...e)=>this.chain(new tn(e,this.commandOptions));zrevrank=(e,t)=>this.chain(new sn([e,t],this.commandOptions));zscan=(...e)=>this.chain(new nn(e,this.commandOptions));zscore=(e,t)=>this.chain(new rn([e,t],this.commandOptions));zunionstore=(...e)=>this.chain(new on(e,this.commandOptions));zunion=(...e)=>this.chain(new cn(e,this.commandOptions));get json(){return{arrappend:(...e)=>this.chain(new Ke(e,this.commandOptions)),arrindex:(...e)=>this.chain(new Ve(e,this.commandOptions)),arrinsert:(...e)=>this.chain(new qe(e,this.commandOptions)),arrlen:(...e)=>this.chain(new Ze(e,this.commandOptions)),arrpop:(...e)=>this.chain(new Qe(e,this.commandOptions)),arrtrim:(...e)=>this.chain(new et(e,this.commandOptions)),clear:(...e)=>this.chain(new tt(e,this.commandOptions)),del:(...e)=>this.chain(new st(e,this.commandOptions)),forget:(...e)=>this.chain(new nt(e,this.commandOptions)),get:(...e)=>this.chain(new it(e,this.commandOptions)),merge:(...e)=>this.chain(new rt(e,this.commandOptions)),mget:(...e)=>this.chain(new ct(e,this.commandOptions)),mset:(...e)=>this.chain(new ot(e,this.commandOptions)),numincrby:(...e)=>this.chain(new ht(e,this.commandOptions)),nummultby:(...e)=>this.chain(new at(e,this.commandOptions)),objkeys:(...e)=>this.chain(new pt(e,this.commandOptions)),objlen:(...e)=>this.chain(new lt(e,this.commandOptions)),resp:(...e)=>this.chain(new ut(e,this.commandOptions)),set:(...e)=>this.chain(new mt(e,this.commandOptions)),strappend:(...e)=>this.chain(new dt(e,this.commandOptions)),strlen:(...e)=>this.chain(new xt(e,this.commandOptions)),toggle:(...e)=>this.chain(new wt(e,this.commandOptions)),type:(...e)=>this.chain(new gt(e,this.commandOptions))}}get functions(){return{load:(...e)=>this.chain(new he(e,this.commandOptions)),list:(...e)=>this.chain(new oe(e,this.commandOptions)),delete:(...e)=>this.chain(new re(e,this.commandOptions)),flush:()=>this.chain(new ce(this.commandOptions)),stats:()=>this.chain(new ae(this.commandOptions)),call:(...e)=>this.chain(new te(e,this.commandOptions)),callRo:(...e)=>this.chain(new se(e,this.commandOptions))}}},En=new Set(["scan","keys","flushdb","flushall","dbsize","hscan","hgetall","hkeys","lrange","sscan","smembers","xrange","xrevrange","zscan","zrange","exec"]),Sn=class{pipelinePromises=new WeakMap;activePipeline=null;indexInCurrentPipeline=0;redis;pipeline;pipelineCounter=0;constructor(e){this.redis=e,this.pipeline=e.pipeline()}async withAutoPipeline(e){let t=this.activePipeline??this.redis.pipeline();this.activePipeline||(this.activePipeline=t,this.indexInCurrentPipeline=0);let s=this.indexInCurrentPipeline++;e(t);let n=this.deferExecution().then(()=>{if(!this.pipelinePromises.has(t)){let c=t.exec({keepErrors:!0});this.pipelineCounter+=1,this.pipelinePromises.set(t,c),this.activePipeline=null}return this.pipelinePromises.get(t)}),i=(await n)[s];if(i.error)throw new E(`Command failed: ${i.error}`);return i.result}async deferExecution(){await Promise.resolve(),await Promise.resolve()}},An=class extends r{constructor(e,t){super([],{...t,headers:{Accept:"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"},path:["psubscribe",...e],streamOptions:{isStreaming:!0,onMessage:t?.streamOptions?.onMessage,signal:t?.streamOptions?.signal}})}},ln=class extends EventTarget{subscriptions;client;listeners;opts;constructor(e,t,s=!1,n){for(let i of(super(),this.client=e,this.subscriptions=new Map,this.listeners=new Map,this.opts=n,t))s?this.subscribeToPattern(i):this.subscribeToChannel(i)}subscribeToChannel(e){let t=new AbortController,s=new Tn([e],{streamOptions:{signal:t.signal,onMessage:n=>this.handleMessage(n,!1)}});s.exec(this.client).catch(n=>{n.name!=="AbortError"&&this.dispatchToListeners("error",n)}),this.subscriptions.set(e,{command:s,controller:t,isPattern:!1})}subscribeToPattern(e){let t=new AbortController,s=new An([e],{streamOptions:{signal:t.signal,onMessage:n=>this.handleMessage(n,!0)}});s.exec(this.client).catch(n=>{n.name!=="AbortError"&&this.dispatchToListeners("error",n)}),this.subscriptions.set(e,{command:s,controller:t,isPattern:!0})}handleMessage(e,t){let s=e.replace(/^data:\s*/,""),n=s.indexOf(","),i=s.indexOf(",",n+1),c=t?s.indexOf(",",i+1):-1;if(n!==-1&&i!==-1){let o=s.slice(0,n);if(t&&o==="pmessage"&&c!==-1){let a=s.slice(n+1,i),h=s.slice(i+1,c),x=s.slice(c+1);try{let w=this.opts?.automaticDeserialization===!1?x:JSON.parse(x);this.dispatchToListeners("pmessage",{pattern:a,channel:h,message:w}),this.dispatchToListeners(`pmessage:${a}`,{pattern:a,channel:h,message:w})}catch(w){this.dispatchToListeners("error",Error(`Failed to parse message: ${w}`))}}else{let a=s.slice(n+1,i),h=s.slice(i+1);try{if(o==="subscribe"||o==="psubscribe"||o==="unsubscribe"||o==="punsubscribe"){let x=Number.parseInt(h);this.dispatchToListeners(o,x)}else{let x=this.opts?.automaticDeserialization===!1?h:Rn(h);this.dispatchToListeners(o,{channel:a,message:x}),this.dispatchToListeners(`${o}:${a}`,{channel:a,message:x})}}catch(x){this.dispatchToListeners("error",Error(`Failed to parse message: ${x}`))}}}}dispatchToListeners(e,t){let s=this.listeners.get(e);if(s)for(let n of s)n(t)}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e)?.add(t)}removeAllListeners(){this.listeners.clear()}async unsubscribe(e){if(e)for(let t of e){let s=this.subscriptions.get(t);if(s){try{s.controller.abort()}catch{}this.subscriptions.delete(t)}}else{for(let t of this.subscriptions.values())try{t.controller.abort()}catch{}this.subscriptions.clear(),this.removeAllListeners()}}getSubscribedChannels(){return[...this.subscriptions.keys()]}},Tn=class extends r{constructor(e,t){super([],{...t,headers:{Accept:"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"},path:["subscribe",...e],streamOptions:{isStreaming:!0,onMessage:t?.streamOptions?.onMessage,signal:t?.streamOptions?.signal}})}},Rn=e=>{try{return JSON.parse(e)}catch{return e}},vn=class{script;sha1;redis;constructor(e,t){this.redis=e,this.script=t,this.sha1="",this.init(t)}async init(e){this.sha1||(this.sha1=await this.digest(e))}async eval(e,t){return await this.init(this.script),await this.redis.eval(this.script,e,t)}async evalsha(e,t){return await this.init(this.script),await this.redis.evalsha(this.sha1,e,t)}async exec(e,t){return await this.init(this.script),await this.redis.evalsha(this.sha1,e,t).catch(async s=>{if(s instanceof Error&&s.message.toLowerCase().includes("noscript"))return await this.redis.eval(this.script,e,t);throw s})}async digest(e){let t=new TextEncoder().encode(e);return[...new Uint8Array(await R.digest("SHA-1",t))].map(s=>s.toString(16).padStart(2,"0")).join("")}},Nn=class{script;sha1;redis;constructor(e,t){this.redis=e,this.sha1="",this.script=t,this.init(t)}async init(e){this.sha1||(this.sha1=await this.digest(e))}async evalRo(e,t){return await this.init(this.script),await this.redis.evalRo(this.script,e,t)}async evalshaRo(e,t){return await this.init(this.script),await this.redis.evalshaRo(this.sha1,e,t)}async exec(e,t){return await this.init(this.script),await this.redis.evalshaRo(this.sha1,e,t).catch(async s=>{if(s instanceof Error&&s.message.toLowerCase().includes("noscript"))return await this.redis.evalRo(this.script,e,t);throw s})}async digest(e){let t=new TextEncoder().encode(e);return[...new Uint8Array(await R.digest("SHA-1",t))].map(s=>s.toString(16).padStart(2,"0")).join("")}},zn=class{client;opts;enableTelemetry;enableAutoPipelining;constructor(e,t){this.client=e,this.opts=t,this.enableTelemetry=t?.enableTelemetry??!0,t?.readYourWrites===!1&&(this.client.readYourWrites=!1),this.enableAutoPipelining=t?.enableAutoPipelining??!0}get readYourWritesSyncToken(){return this.client.upstashSyncToken}set readYourWritesSyncToken(e){this.client.upstashSyncToken=e}get json(){return{arrappend:(...e)=>new Ke(e,this.opts).exec(this.client),arrindex:(...e)=>new Ve(e,this.opts).exec(this.client),arrinsert:(...e)=>new qe(e,this.opts).exec(this.client),arrlen:(...e)=>new Ze(e,this.opts).exec(this.client),arrpop:(...e)=>new Qe(e,this.opts).exec(this.client),arrtrim:(...e)=>new et(e,this.opts).exec(this.client),clear:(...e)=>new tt(e,this.opts).exec(this.client),del:(...e)=>new st(e,this.opts).exec(this.client),forget:(...e)=>new nt(e,this.opts).exec(this.client),get:(...e)=>new it(e,this.opts).exec(this.client),merge:(...e)=>new rt(e,this.opts).exec(this.client),mget:(...e)=>new ct(e,this.opts).exec(this.client),mset:(...e)=>new ot(e,this.opts).exec(this.client),numincrby:(...e)=>new ht(e,this.opts).exec(this.client),nummultby:(...e)=>new at(e,this.opts).exec(this.client),objkeys:(...e)=>new pt(e,this.opts).exec(this.client),objlen:(...e)=>new lt(e,this.opts).exec(this.client),resp:(...e)=>new ut(e,this.opts).exec(this.client),set:(...e)=>new mt(e,this.opts).exec(this.client),strappend:(...e)=>new dt(e,this.opts).exec(this.client),strlen:(...e)=>new xt(e,this.opts).exec(this.client),toggle:(...e)=>new wt(e,this.opts).exec(this.client),type:(...e)=>new gt(e,this.opts).exec(this.client)}}get functions(){return{load:(...e)=>new he(e,this.opts).exec(this.client),list:(...e)=>new oe(e,this.opts).exec(this.client),delete:(...e)=>new re(e,this.opts).exec(this.client),flush:()=>new ce(this.opts).exec(this.client),stats:()=>new ae(this.opts).exec(this.client),call:(...e)=>new te(e,this.opts).exec(this.client),callRo:(...e)=>new se(e,this.opts).exec(this.client)}}use=e=>{let t=this.client.request.bind(this.client);this.client.request=s=>e(s,t)};addTelemetry=e=>{if(this.enableTelemetry)try{this.client.mergeTelemetry(e)}catch{}};createScript(e,t){return t?.readonly?new Nn(this,e):new vn(this,e)}pipeline=()=>new pn({client:this.client,commandOptions:this.opts,multiExec:!1});autoPipeline=()=>function e(t,s="root"){return t.autoPipelineExecutor||(t.autoPipelineExecutor=new Sn(t)),new Proxy(t,{get:(n,i)=>{if(i==="pipelineCounter")return n.autoPipelineExecutor.pipelineCounter;if(s==="root"&&i==="json")return e(n,"json");if(s==="root"&&i==="functions")return e(n,"functions");if(s==="root"){let a=i in n&&!(i in n.autoPipelineExecutor.pipeline),h=En.has(i);if(a||h)return n[i]}let c=n.autoPipelineExecutor.pipeline,o=s==="json"?c.json[i]:s==="functions"?c.functions[i]:c[i];return typeof o=="function"?(...a)=>n.autoPipelineExecutor.withAutoPipeline(h=>{(s==="json"?h.json[i]:s==="functions"?h.functions[i]:h[i])(...a)}):o}})}(this);multi=()=>new pn({client:this.client,commandOptions:this.opts,multiExec:!0});bitfield=(...e)=>new _(e,this.client,this.opts);append=(...e)=>new D(e,this.opts).exec(this.client);bitcount=(...e)=>new J(e,this.opts).exec(this.client);bitop=(e,t,s,...n)=>new j([e,t,s,...n],this.opts).exec(this.client);bitpos=(...e)=>new $(e,this.opts).exec(this.client);copy=(...e)=>new F(e,this.opts).exec(this.client);dbsize=()=>new Y(this.opts).exec(this.client);decr=(...e)=>new G(e,this.opts).exec(this.client);decrby=(...e)=>new X(e,this.opts).exec(this.client);del=(...e)=>new B(e,this.opts).exec(this.client);echo=(...e)=>new W(e,this.opts).exec(this.client);evalRo=(...e)=>new H(e,this.opts).exec(this.client);eval=(...e)=>new K(e,this.opts).exec(this.client);evalshaRo=(...e)=>new V(e,this.opts).exec(this.client);evalsha=(...e)=>new q(e,this.opts).exec(this.client);exec=e=>new On(e,this.opts).exec(this.client);exists=(...e)=>new Z(e,this.opts).exec(this.client);expire=(...e)=>new Q(e,this.opts).exec(this.client);expireat=(...e)=>new ee(e,this.opts).exec(this.client);flushall=e=>new ne(e,this.opts).exec(this.client);flushdb=(...e)=>new ie(e,this.opts).exec(this.client);geoadd=(...e)=>new pe(e,this.opts).exec(this.client);geopos=(...e)=>new me(e,this.opts).exec(this.client);geodist=(...e)=>new le(e,this.opts).exec(this.client);geohash=(...e)=>new ue(e,this.opts).exec(this.client);geosearch=(...e)=>new de(e,this.opts).exec(this.client);geosearchstore=(...e)=>new xe(e,this.opts).exec(this.client);get=(...e)=>new we(e,this.opts).exec(this.client);getbit=(...e)=>new ge(e,this.opts).exec(this.client);getdel=(...e)=>new ye(e,this.opts).exec(this.client);getex=(...e)=>new Oe(e,this.opts).exec(this.client);getrange=(...e)=>new fe(e,this.opts).exec(this.client);getset=(e,t)=>new be([e,t],this.opts).exec(this.client);hdel=(...e)=>new Ee(e,this.opts).exec(this.client);hexists=(...e)=>new Se(e,this.opts).exec(this.client);hexpire=(...e)=>new Ae(e,this.opts).exec(this.client);hexpireat=(...e)=>new Te(e,this.opts).exec(this.client);hexpiretime=(...e)=>new Re(e,this.opts).exec(this.client);httl=(...e)=>new Ge(e,this.opts).exec(this.client);hpexpire=(...e)=>new Ne(e,this.opts).exec(this.client);hpexpireat=(...e)=>new ze(e,this.opts).exec(this.client);hpexpiretime=(...e)=>new ke(e,this.opts).exec(this.client);hpttl=(...e)=>new Ie(e,this.opts).exec(this.client);hpersist=(...e)=>new ve(e,this.opts).exec(this.client);hget=(...e)=>new Ce(e,this.opts).exec(this.client);hgetall=(...e)=>new Ue(e,this.opts).exec(this.client);hincrby=(...e)=>new Me(e,this.opts).exec(this.client);hincrbyfloat=(...e)=>new Pe(e,this.opts).exec(this.client);hkeys=(...e)=>new Le(e,this.opts).exec(this.client);hlen=(...e)=>new De(e,this.opts).exec(this.client);hmget=(...e)=>new Je(e,this.opts).exec(this.client);hmset=(e,t)=>new _e([e,t],this.opts).exec(this.client);hrandfield=(e,t,s)=>new L([e,t,s],this.opts).exec(this.client);hscan=(...e)=>new je(e,this.opts).exec(this.client);hset=(e,t)=>new $e([e,t],this.opts).exec(this.client);hsetnx=(e,t,s)=>new Fe([e,t,s],this.opts).exec(this.client);hstrlen=(...e)=>new Ye(e,this.opts).exec(this.client);hvals=(...e)=>new Xe(e,this.opts).exec(this.client);incr=(...e)=>new Be(e,this.opts).exec(this.client);incrby=(...e)=>new We(e,this.opts).exec(this.client);incrbyfloat=(...e)=>new He(e,this.opts).exec(this.client);keys=(...e)=>new yt(e,this.opts).exec(this.client);lindex=(...e)=>new Ot(e,this.opts).exec(this.client);linsert=(e,t,s,n)=>new ft([e,t,s,n],this.opts).exec(this.client);llen=(...e)=>new bt(e,this.opts).exec(this.client);lmove=(...e)=>new Et(e,this.opts).exec(this.client);lpop=(...e)=>new At(e,this.opts).exec(this.client);lmpop=(...e)=>new St(e,this.opts).exec(this.client);lpos=(...e)=>new Tt(e,this.opts).exec(this.client);lpush=(e,...t)=>new Rt([e,...t],this.opts).exec(this.client);lpushx=(e,...t)=>new vt([e,...t],this.opts).exec(this.client);lrange=(...e)=>new Nt(e,this.opts).exec(this.client);lrem=(e,t,s)=>new zt([e,t,s],this.opts).exec(this.client);lset=(e,t,s)=>new kt([e,t,s],this.opts).exec(this.client);ltrim=(...e)=>new It(e,this.opts).exec(this.client);mget=(...e)=>new Ct(e,this.opts).exec(this.client);mset=e=>new Ut([e],this.opts).exec(this.client);msetnx=e=>new Mt([e],this.opts).exec(this.client);persist=(...e)=>new Pt(e,this.opts).exec(this.client);pexpire=(...e)=>new Lt(e,this.opts).exec(this.client);pexpireat=(...e)=>new Dt(e,this.opts).exec(this.client);pfadd=(...e)=>new Jt(e,this.opts).exec(this.client);pfcount=(...e)=>new _t(e,this.opts).exec(this.client);pfmerge=(...e)=>new jt(e,this.opts).exec(this.client);ping=e=>new $t(e,this.opts).exec(this.client);psetex=(e,t,s)=>new Ft([e,t,s],this.opts).exec(this.client);psubscribe=e=>{let t=Array.isArray(e)?e:[e];return new ln(this.client,t,!0,this.opts)};pttl=(...e)=>new Yt(e,this.opts).exec(this.client);publish=(...e)=>new Gt(e,this.opts).exec(this.client);randomkey=()=>new Xt().exec(this.client);rename=(...e)=>new Bt(e,this.opts).exec(this.client);renamenx=(...e)=>new Wt(e,this.opts).exec(this.client);rpop=(...e)=>new Ht(e,this.opts).exec(this.client);rpush=(e,...t)=>new Kt([e,...t],this.opts).exec(this.client);rpushx=(e,...t)=>new Vt([e,...t],this.opts).exec(this.client);sadd=(e,t,...s)=>new qt([e,t,...s],this.opts).exec(this.client);scan(e,t){return new Zt([e,t],this.opts).exec(this.client)}scard=(...e)=>new Qt(e,this.opts).exec(this.client);scriptExists=(...e)=>new es(e,this.opts).exec(this.client);scriptFlush=(...e)=>new ts(e,this.opts).exec(this.client);scriptLoad=(...e)=>new ss(e,this.opts).exec(this.client);sdiff=(...e)=>new ns(e,this.opts).exec(this.client);sdiffstore=(...e)=>new is(e,this.opts).exec(this.client);set=(e,t,s)=>new rs([e,t,s],this.opts).exec(this.client);setbit=(...e)=>new cs(e,this.opts).exec(this.client);setex=(e,t,s)=>new os([e,t,s],this.opts).exec(this.client);setnx=(e,t)=>new hs([e,t],this.opts).exec(this.client);setrange=(...e)=>new as(e,this.opts).exec(this.client);sinter=(...e)=>new ps(e,this.opts).exec(this.client);sinterstore=(...e)=>new ls(e,this.opts).exec(this.client);sismember=(e,t)=>new us([e,t],this.opts).exec(this.client);smismember=(e,t)=>new ds([e,t],this.opts).exec(this.client);smembers=(...e)=>new ms(e,this.opts).exec(this.client);smove=(e,t,s)=>new xs([e,t,s],this.opts).exec(this.client);spop=(...e)=>new ws(e,this.opts).exec(this.client);srandmember=(...e)=>new gs(e,this.opts).exec(this.client);srem=(e,...t)=>new ys([e,...t],this.opts).exec(this.client);sscan=(...e)=>new Os(e,this.opts).exec(this.client);strlen=(...e)=>new fs(e,this.opts).exec(this.client);subscribe=e=>{let t=Array.isArray(e)?e:[e];return new ln(this.client,t,!1,this.opts)};sunion=(...e)=>new bs(e,this.opts).exec(this.client);sunionstore=(...e)=>new Es(e,this.opts).exec(this.client);time=()=>new Ss().exec(this.client);touch=(...e)=>new As(e,this.opts).exec(this.client);ttl=(...e)=>new Ts(e,this.opts).exec(this.client);type=(...e)=>new Rs(e,this.opts).exec(this.client);unlink=(...e)=>new vs(e,this.opts).exec(this.client);xadd=(...e)=>new zs(e,this.opts).exec(this.client);xack=(...e)=>new Ns(e,this.opts).exec(this.client);xdel=(...e)=>new Cs(e,this.opts).exec(this.client);xgroup=(...e)=>new Us(e,this.opts).exec(this.client);xread=(...e)=>new Js(e,this.opts).exec(this.client);xreadgroup=(...e)=>new _s(e,this.opts).exec(this.client);xinfo=(...e)=>new Ms(e,this.opts).exec(this.client);xlen=(...e)=>new Ps(e,this.opts).exec(this.client);xpending=(...e)=>new Ls(e,this.opts).exec(this.client);xclaim=(...e)=>new Is(e,this.opts).exec(this.client);xautoclaim=(...e)=>new ks(e,this.opts).exec(this.client);xtrim=(...e)=>new $s(e,this.opts).exec(this.client);xrange=(...e)=>new Ds(e,this.opts).exec(this.client);xrevrange=(...e)=>new js(e,this.opts).exec(this.client);zadd=(...e)=>("score"in e[1],new Fs([e[0],e[1],...e.slice(2)],this.opts).exec(this.client));zcard=(...e)=>new Ys(e,this.opts).exec(this.client);zcount=(...e)=>new Gs(e,this.opts).exec(this.client);zdiffstore=(...e)=>new hn(e,this.opts).exec(this.client);zincrby=(e,t,s)=>new Xs([e,t,s],this.opts).exec(this.client);zinterstore=(...e)=>new Bs(e,this.opts).exec(this.client);zlexcount=(...e)=>new Ws(e,this.opts).exec(this.client);zmscore=(...e)=>new an(e,this.opts).exec(this.client);zpopmax=(...e)=>new Hs(e,this.opts).exec(this.client);zpopmin=(...e)=>new Ks(e,this.opts).exec(this.client);zrange=(...e)=>new Vs(e,this.opts).exec(this.client);zrank=(e,t)=>new qs([e,t],this.opts).exec(this.client);zrem=(e,...t)=>new Zs([e,...t],this.opts).exec(this.client);zremrangebylex=(...e)=>new Qs(e,this.opts).exec(this.client);zremrangebyrank=(...e)=>new en(e,this.opts).exec(this.client);zremrangebyscore=(...e)=>new tn(e,this.opts).exec(this.client);zrevrank=(e,t)=>new sn([e,t],this.opts).exec(this.client);zscan=(...e)=>new nn(e,this.opts).exec(this.client);zscore=(e,t)=>new rn([e,t],this.opts).exec(this.client);zunion=(...e)=>new cn(e,this.opts).exec(this.client);zunionstore=(...e)=>new on(e,this.opts).exec(this.client)},kn=A(5356).Buffer;"u"<typeof atob&&(wn.atob=e=>kn.from(e,"base64").toString("utf8"));var In=class dn extends zn{constructor(t){if("request"in t)return void super(t);t.url?(t.url.startsWith(" ")||t.url.endsWith(" ")||/\r|\n/.test(t.url))&&console.warn("[Upstash Redis] The redis url contains whitespace or newline, which can cause errors!"):console.warn("[Upstash Redis] The 'url' property is missing or undefined in your Redis config."),t.token?(t.token.startsWith(" ")||t.token.endsWith(" ")||/\r|\n/.test(t.token))&&console.warn("[Upstash Redis] The redis token contains whitespace or newline, which can cause errors!"):console.warn("[Upstash Redis] The 'token' property is missing or undefined in your Redis config.");let s=new O({baseUrl:t.url,retry:t.retry,headers:{authorization:`Bearer ${t.token}`},agent:t.agent,responseEncoding:t.responseEncoding,cache:t.cache??"no-store",signal:t.signal,keepAlive:t.keepAlive,readYourWrites:t.readYourWrites}),n=typeof process=="object"&&process&&typeof process.env=="object"&&process.env?process.env:{};if(super(s,{automaticDeserialization:t.automaticDeserialization,enableTelemetry:t.enableTelemetry??!n.UPSTASH_DISABLE_TELEMETRY,latencyLogging:t.latencyLogging,enableAutoPipelining:t.enableAutoPipelining}),typeof process=="object"&&process&&process.version,this.addTelemetry({runtime:"edge-light",platform:n.UPSTASH_CONSOLE?"console":n.VERCEL?"vercel":n.AWS_REGION?"aws":"unknown",sdk:"@upstash/redis@v1.36.1"}),this.enableAutoPipelining)return this.autoPipeline()}static fromEnv(t){if(typeof process!="object"||!process||typeof process.env!="object"||!process.env)throw TypeError('[Upstash Redis] Unable to get environment variables, `process.env` is undefined. If you are deploying to cloudflare, please import from "@upstash/redis/cloudflare" instead');let s=process.env.UPSTASH_REDIS_REST_URL||process.env.KV_REST_API_URL;s||console.warn("[Upstash Redis] Unable to find environment variable: `UPSTASH_REDIS_REST_URL`");let n=process.env.UPSTASH_REDIS_REST_TOKEN||process.env.KV_REST_API_TOKEN;return n||console.warn("[Upstash Redis] Unable to find environment variable: `UPSTASH_REDIS_REST_TOKEN`"),new dn({...t,url:s,token:n})}}},M);export{Mn as __getNamedExports};
