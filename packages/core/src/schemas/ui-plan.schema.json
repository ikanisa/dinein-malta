{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://dinein.app/schemas/ui_plan.v1.json",
    "title": "DineIn UIPlan v1",
    "type": "object",
    "additionalProperties": false,
    "required": [
        "version",
        "planId",
        "generatedAt",
        "tenant",
        "session",
        "screen",
        "sections",
        "actions",
        "cache"
    ],
    "properties": {
        "version": {
            "type": "string",
            "const": "ui_plan.v1"
        },
        "planId": {
            "type": "string",
            "minLength": 8
        },
        "generatedAt": {
            "type": "string",
            "format": "date-time"
        },
        "tenant": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "tenantId"
            ],
            "properties": {
                "tenantId": {
                    "type": "string",
                    "minLength": 3
                },
                "venueId": {
                    "type": [
                        "string",
                        "null"
                    ]
                }
            }
        },
        "session": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "sessionKey",
                "actor"
            ],
            "properties": {
                "sessionKey": {
                    "type": "string",
                    "minLength": 8
                },
                "actor": {
                    "type": "object",
                    "additionalProperties": false,
                    "required": [
                        "actorType",
                        "actorId"
                    ],
                    "properties": {
                        "actorType": {
                            "type": "string",
                            "enum": [
                                "guest",
                                "staff",
                                "admin"
                            ]
                        },
                        "actorId": {
                            "type": "string",
                            "minLength": 3
                        },
                        "locale": {
                            "type": [
                                "string",
                                "null"
                            ]
                        },
                        "currency": {
                            "type": [
                                "string",
                                "null"
                            ]
                        }
                    }
                }
            }
        },
        "screen": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "name",
                "title",
                "layout"
            ],
            "properties": {
                "name": {
                    "type": "string",
                    "enum": [
                        "home",
                        "search",
                        "venue",
                        "menu",
                        "item",
                        "checkout",
                        "orders",
                        "chat_waiter",
                        "profile"
                    ]
                },
                "title": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 60
                },
                "layout": {
                    "type": "string",
                    "enum": [
                        "scroll",
                        "tabs",
                        "sheet",
                        "modal"
                    ]
                },
                "breadcrumbs": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "additionalProperties": false,
                        "required": [
                            "label"
                        ],
                        "properties": {
                            "label": {
                                "type": "string",
                                "minLength": 1,
                                "maxLength": 30
                            },
                            "actionRef": {
                                "type": [
                                    "string",
                                    "null"
                                ]
                            }
                        }
                    }
                }
            }
        },
        "sections": {
            "type": "array",
            "minItems": 1,
            "maxItems": 50,
            "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                    "id",
                    "type",
                    "title",
                    "items"
                ],
                "properties": {
                    "id": {
                        "type": "string",
                        "minLength": 3
                    },
                    "type": {
                        "type": "string",
                        "enum": [
                            "hero",
                            "chips",
                            "carousel",
                            "grid",
                            "list",
                            "banner",
                            "metrics",
                            "divider",
                            "cta"
                        ]
                    },
                    "title": {
                        "type": [
                            "string",
                            "null"
                        ],
                        "maxLength": 40
                    },
                    "subtitle": {
                        "type": [
                            "string",
                            "null"
                        ],
                        "maxLength": 80
                    },
                    "style": {
                        "type": "object",
                        "additionalProperties": false,
                        "properties": {
                            "emphasis": {
                                "type": "string",
                                "enum": [
                                    "low",
                                    "medium",
                                    "high"
                                ]
                            },
                            "density": {
                                "type": "string",
                                "enum": [
                                    "compact",
                                    "regular"
                                ]
                            },
                            "themeToken": {
                                "type": [
                                    "string",
                                    "null"
                                ]
                            }
                        }
                    },
                    "items": {
                        "type": "array",
                        "minItems": 0,
                        "maxItems": 100,
                        "items": {
                            "type": "object",
                            "additionalProperties": false,
                            "required": [
                                "kind",
                                "id",
                                "primaryText"
                            ],
                            "properties": {
                                "kind": {
                                    "type": "string",
                                    "enum": [
                                        "venue",
                                        "menu_item",
                                        "offer",
                                        "category",
                                        "info",
                                        "action"
                                    ]
                                },
                                "id": {
                                    "type": "string",
                                    "minLength": 1
                                },
                                "primaryText": {
                                    "type": "string",
                                    "minLength": 1,
                                    "maxLength": 60
                                },
                                "secondaryText": {
                                    "type": [
                                        "string",
                                        "null"
                                    ],
                                    "maxLength": 120
                                },
                                "meta": {
                                    "type": "object",
                                    "additionalProperties": false,
                                    "properties": {
                                        "badge": {
                                            "type": [
                                                "string",
                                                "null"
                                            ],
                                            "maxLength": 16
                                        },
                                        "priceText": {
                                            "type": [
                                                "string",
                                                "null"
                                            ],
                                            "maxLength": 24
                                        },
                                        "ratingText": {
                                            "type": [
                                                "string",
                                                "null"
                                            ],
                                            "maxLength": 24
                                        },
                                        "distanceText": {
                                            "type": [
                                                "string",
                                                "null"
                                            ],
                                            "maxLength": 24
                                        },
                                        "availabilityText": {
                                            "type": [
                                                "string",
                                                "null"
                                            ],
                                            "maxLength": 24
                                        }
                                    }
                                },
                                "media": {
                                    "type": "object",
                                    "additionalProperties": false,
                                    "properties": {
                                        "imageUrl": {
                                            "type": [
                                                "string",
                                                "null"
                                            ],
                                            "format": "uri"
                                        },
                                        "aspect": {
                                            "type": [
                                                "string",
                                                "null"
                                            ],
                                            "enum": [
                                                "1:1",
                                                "4:3",
                                                "16:9",
                                                null
                                            ]
                                        }
                                    }
                                },
                                "actionRef": {
                                    "type": [
                                        "string",
                                        "null"
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        },
        "actions": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "byId"
            ],
            "properties": {
                "byId": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "object",
                        "additionalProperties": false,
                        "required": [
                            "intent"
                        ],
                        "properties": {
                            "intent": {
                                "type": "string",
                                "enum": [
                                    "openHome",
                                    "openSearch",
                                    "openVenue",
                                    "openMenu",
                                    "openItem",
                                    "applyFilter",
                                    "clearFilters",
                                    "startVisit",
                                    "addToCart",
                                    "updateCartItem",
                                    "removeFromCart",
                                    "openCheckout",
                                    "confirmOrder",
                                    "openChatWaiter",
                                    "sendWaiterMessage",
                                    "callStaff",
                                    "requestBill",
                                    "openOrders",
                                    "trackOrder",
                                    "openExternalUrl"
                                ]
                            },
                            "params": {
                                "type": "object",
                                "additionalProperties": true
                            },
                            "requiresConfirmation": {
                                "type": [
                                    "boolean",
                                    "null"
                                ]
                            },
                            "confirmationText": {
                                "type": [
                                    "string",
                                    "null"
                                ],
                                "maxLength": 120
                            }
                        }
                    }
                }
            }
        },
        "cache": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "ttlSeconds"
            ],
            "properties": {
                "ttlSeconds": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 900
                },
                "varyBy": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": [
                            "location",
                            "locale",
                            "guestProfile",
                            "venueId"
                        ]
                    }
                }
            }
        },
        "debug": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "explanation": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "maxLength": 800
                },
                "sourceToolCalls": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "additionalProperties": false,
                        "required": [
                            "tool",
                            "correlationId"
                        ],
                        "properties": {
                            "tool": {
                                "type": "string"
                            },
                            "correlationId": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        }
    }
}